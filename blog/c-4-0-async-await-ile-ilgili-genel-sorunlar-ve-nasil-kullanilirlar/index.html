<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>C# 4.0 async ve await ile ilgili genel sorunlar ve nasıl kullanılırlar</title>
    
    <meta name="description" content="Ruby, JavaScript, Clojure ve diğer yazılım maceralarım
">
    
    <link rel="canonical" href="http://turhancoskun.com/blog/c-4-0-async-await-ile-ilgili-genel-sorunlar-ve-nasil-kullanilirlar/">
</head>


<body>
  <div class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    <figure>
      <img class="post-avatar" src="/assets/profile200x200.jpg" alt="Turhan Coskun" />
    </figure>
    <hgroup>
      <h1 class="brand-title">Turhan Coskun</h1>
      <h2 class="brand-tagline">Ruby, JavaScript, Clojure ve diğer yazılım maceralarım
</h2>
    </hgroup>
    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item">
          <a class="pure-button" href="/">Ana Sayfa</a>
        </li>
        <li class="nav-item">
          <a class="pure-button" href="/aboutme">Hakkımda</a>
        </li>
        <li class="nav-item">
          <a class="pure-button" href="/etiketler">Etiketler</a>
        </li>
      </ul>
    </nav>
    <footer>
      <div>
  <p>
    <ul class="social-media-list">
      
      <li>
        <a href="https://github.com/turhn">
          <svg class="social-icon" viewBox="0 0 16 16">
            <path fill="#FFF" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
          </svg>
          <span>turhn</span>
        </a>
      </li>
      

      
      <li>
        <a href="https://twitter.com/turhanco">
          <svg class="social-icon" viewBox="0 0 16 16">
            <path fill="#FFF" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
            c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
          </svg>
          <span>turhanco</span>
        </a>
      </li>
      
    </ul>
  </p>
  <p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p>
</div>

    </footer>
  </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
      <div>
        <div class="post">

  <p>
    <a href="/"><< Ana Sayfaya Dön</a>
  </p>

  <header class="post-header">
    <h1 class="post-title">C# 4.0 async ve await ile ilgili genel sorunlar ve nasıl kullanılırlar</h1>
    <p class="post-meta">Apr 17, 2013
    
        <a class="post-category" href="/tag/.NET">.NET</a>
    
        <a class="post-category" href="/tag/C#">C#</a>
    
    </p>
  </header>

  <article class="post-content">
    <p>C# ta asenkron programlamada kullanılan c# async await anahtar kelimelerinden bahsetmek istiyorum.</p>

<p>Öncelikle “<em>Cannot find all types required by the ‘async’ modifier. Are you targeting the wrong framework version, or missing a reference to an assembly</em>?” hatası alıyorsanız C# 5.0 ile gelen bu özellikleri C# 4.0 da kullanmaya çalışıyorsunuz demektir.</p>

<p>Çözüm için <strong>Microsoft.CompilerServices.AsyncTargetingPack </strong>isimli NuGet paketini projeye dahil etmeniz yeterli.</p>

<p>Daha sonra “<em>This async method lacks ‘await’ operators and will run synchronously. Consider using the ‘await’ operator to await non-blocking API calls, or ‘await Task.Run(…)’ to do CPU-bound work on a background thread” </em> uyarısını almanız olası. Bu async ile tanımladığınız bir metotda await bulamadığını dolayısı ile kodunuzun asenkron değil de senkron çalışacağını belirtiyor. Bu şu demek eğer metodumuzu oluştururken async olarak tanımladıysak muhakkak içinde await geçmeli. Aşağıdaki örneklerde görebilirsiniz.</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">public</span> <span class="k">class</span> <span class="nc">Login</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Email</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">Parola</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>Login isimli bir sınıf tanımladık. Bunu birden fazla parametreyi paket halinde asenkron metodumuza sokmak için kullanmak üzere örnek olarak oluşturdum</p>

<div class="highlight"><pre><code class="language-csharp" data-lang="csharp"><span class="k">private</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">KontrolEt</span><span class="p">(</span><span class="n">Login</span> <span class="n">grs</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">DataContext</span> <span class="n">db</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DataContext</span><span class="p">();</span>
  <span class="n">Task</span> <span class="n">myTask</span> <span class="p">=</span> <span class="n">Task</span><span class="p">.</span><span class="n">Factory</span><span class="p">.</span><span class="n">StartNew</span><span class="p">(</span><span class="k">new</span> <span class="n">Func</span><span class="p">(()</span> <span class="p">=&gt;</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="n">db</span><span class="p">.</span><span class="n">Users</span><span class="p">.</span><span class="n">Any</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">Email</span><span class="p">.</span><span class="n">ToLower</span><span class="p">()</span> <span class="p">==</span> <span class="n">grs</span><span class="p">.</span><span class="n">Email</span><span class="p">.</span><span class="n">ToLower</span><span class="p">()</span> <span class="p">&amp;&amp;</span> <span class="n">x</span><span class="p">.</span><span class="n">Password</span> <span class="p">==</span> <span class="n">grs</span><span class="p">.</span><span class="n">Parola</span><span class="p">);</span>
    <span class="p">}));</span>

    <span class="k">return</span> <span class="k">await</span> <span class="n">myTask</span><span class="p">;</span>
  <span class="p">}</span></code></pre></div>

<p>Burada KontrolEt isimli asenkron bir metot oluşturduk. Metodumuza Login sınıfından giriş bilgilerini veritabanından sorgu yapmak için kullanacağız.</p>
<p>private async void Button_Click_1(object sender, RoutedEventArgs e)</p>
<p>Butonumuzun click olayını async olacak şekilde yeniden düzenliyoruz. KontrolEt metodunu asenkron çağırmak ve bool tipinde veriye aktarmak için aşağıdaki kodu ekliyoruz.</p>
<p>bool isValid = await KontrolEt(new Login { Email=tbEmail.Text, Parola=tbParola.Text });</p>
<p><strong>Nasıl Kullanılır?<br />
</strong></p>
<ol>
<li>async ifadesi kullanarak bir metot, lambda ifadesi ya da anonim metot oluşturun“private async Task&lt;bool&gt; KontrolEt(Giris grs)“</li>
<li>Buton tıklama gibi arayüz kontrollerine bağlı metotlar dahil olmak üzere tüm await kullanacak metotlar async ile işaretlenmek zorundadır.” private async void Button_Click_1(object sender, RoutedEventArgs e)”</li>
<li>await sadece async ile işaretlenmiş metotlarda kullanılabilir.</li>
<li>async ile işaretlenmiş bir metot yalnıza void, Task ve Task&lt;T&gt; dönüş tiplerine sahip olabilir.</li>
<li>async ile işaretlenmiş bir metot birden fazla await içerebilir.<strong><br />
Kaynaklar:<br />
</strong>
<ol>
<li><strong>http://msdn.microsoft.com/en-us/library/vstudio/hh191443.aspx<br />
</strong></li>
<li>
<address><strong>http://www.codeguru.com/csharp/csharp/introduction-to-async-and-await-keywords-in-c-5.0.htm</strong></address>
</li>
</ol>
</li>
</ol>

  </article>

  <div class="social-share">
    <span>
      <a href="https://twitter.com/share" class="twitter-share-button" data-url="" data-via="turhanco" data-lang="tr">Tweet</a>
    </span>
    <span>
      <div class="fb-like" data-href="" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true">
      </div>
    </span>
  </div>

  <div id="disqus_thread"></div>
  <script type="text/javascript">
  var disqus_shortname = 'turhancoskunblog';
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  </script>

  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  <div id="fb-root"></div>

  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/tr_TR/sdk.js#xfbml=1&appId=1469686916649684&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));</script>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  <p>
    <a href="/">Ana Sayfaya Dön</a>
  </p>

</div>

      </div>
    </div>

  </div>
  <link rel="stylesheet" href="/css/framework/pure-min.css">
  <link rel="stylesheet" href="/css/framework/grids-responsive-min.css">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/site.css">

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-41396472-1', 'auto');
  ga('require', 'displayfeatures');
  ga('send', 'pageview');

</script>

</body>

</html>
